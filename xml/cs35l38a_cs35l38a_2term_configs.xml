<!--
Copyright 2019 Cirrus Logic, Inc.

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License version 2 as
published by the Free Software Foundation.
-->
<?xml version="1.0" encoding="utf-8"?>
<!-- address	mask	value	delay	reserve -->
<NV_CATEGORY NAME="PARAM_VALUE" MODE="GU">

  <PA_STATUS NAME="DOUBLE_PA">
	<SCENCE NAME="INIT_CHIP" CONTROL_MASK="0x11" VALUE="{
		# Delay 200 ms for IC to boot up #
		0x00000000, 0x00000000, 0x00000000, 0xc8, 0x02,

		# Unlock test page #
		0x00000020, 0xffffffff, 0x00005555, 0x00, 0x00,
		0x00000020, 0xffffffff, 0x0000aaaa, 0x00, 0x00,

		# Download JUMP Instruction into RAM #
		0x00000c00, 0xffffffff, 0x00000000, 0x00, 0x00,
		0x00000c08, 0xffffffff, 0x00000001, 0x00, 0x00,
		0x00e02800, 0xffffffff, 0x00dd0102, 0x00, 0x00,
		0x00000c08, 0xffffffff, 0x00000000, 0x00, 0x00,

		# Enable PAC to execute code #
		0x00000c00, 0xffffffff, 0x00000001, 0x00, 0x00,

		# Delay 200 ms #
		0x00000000, 0x00000000, 0x00000000, 0xc8, 0x02,

		# Disable PAC to execute code #
		0x00000c00, 0xffffffff, 0x00000000, 0x00, 0x00,

		# Apply errata #
		# Correct gain flatness #
		0x00007064, 0xffffffff, 0x0929a800, 0x00, 0x00,
		0x00007850, 0xffffffff, 0x00002fa9, 0x00, 0x00,
		0x00007854, 0xffffffff, 0x0003f1d5, 0x00, 0x00,
		0x00007858, 0xffffffff, 0x0003f5e3, 0x00, 0x00,
		0x0000785c, 0xffffffff, 0x00001137, 0x00, 0x00,
		0x00007860, 0xffffffff, 0x0001a7a5, 0x00, 0x00,
		0x00007864, 0xffffffff, 0x0002f16a, 0x00, 0x00,
		0x00007868, 0xffffffff, 0x00003e21, 0x00, 0x00,
		0x00007848, 0xffffffff, 0x00000001, 0x00, 0x00,
		0x00002020, 0xffffffff, 0x00000000, 0x00, 0x00,

		# Fix group delay variation #
		0x00002d10, 0xffffffff, 0x0002c01c, 0x00, 0x00,

		# DC offset #
		0x00007418, 0xffffffff, 0x909001c8, 0x00, 0x00,

		# VBST Err threshold #
		0x0000394c, 0xffffffff, 0x028764b7, 0x00, 0x00,

		# Boost default #
		0x00003810, 0xffffffff, 0x00003c3c, 0x00, 0x00,

		# Update DCM to remove load detection #
		0x0000381c, 0xffffffff, 0x00000051, 0x00, 0x00,

		# Lock test page #
		0x00000020, 0xffffffff, 0x0000cccc, 0x00, 0x00,
		0x00000020, 0xffffffff, 0x00003333, 0x00, 0x00,

		# Set clocking #
		# PLL ref clk = SCLK at 3.072MHz = 48KHz * 64 #
		# Configure and enable PLL #
		0x00002c04, 0xffffffff, 0x00000c20, 0x00, 0x00,
		0x00002c04, 0xffffffff, 0x00000430, 0x00, 0x00,
		0x00002c0c, 0xffffffff, 0x00000003, 0x00, 0x00,

		# Set audio routing for both amplifiers #
		# ASP TX1 = IMON #
		0x00004c20, 0xffffffff, 0x00000019, 0x00, 0x00,
		# ASP TX2 = VMON1 #
		0x00004c24, 0xffffffff, 0x00000018, 0x00, 0x00,

		# Set audio format #
		# I2S Slave mode #
		0x00004808, 0xffffffff, 0x00000002, 0x00, 0x00,
		# RX Slot width = 32 and Data width = 24 bit #
		# TX Slot and Data width = 16 bit #
		0x00004818, 0xffffffff, 0x00200010, 0x00, 0x00,

		# TX in Hi-Z mode when not outputting #
		0x00004800, 0xffffffff, 0x00200024, 0x00, 0x00,

		# Enable blocks: AMP, BST, VBATMON, VBSTMON, TEMPMON, VMON1, IMON #
		0x00002018, 0xffffffff, 0x00003721, 0x00, 0x00,

		# Enable interrupt BST_SHORT_ERR, BST_DCM_UVP, BST_OVP_ERR, TEMP_ERR, TEMP_WARN #
		# Default value is 0xffbffffc #
		0x00d00040, 0xffffffff, 0xf9b8fffc, 0x00, 0x00,
		# Enable interrupt AMP_SHORT_ERR #
		# Default value is 0xf5ffffff #
		0x00d00048, 0xffffffff, 0xf5ffefff, 0x00, 0x00,

		# Gain set to 17dB #
		0x00006c04, 0xffffffff, 0x00000220, 0x00, 0x00,


		# 2ND AMPLIFIER #

		# Delay 200 ms for IC to boot up #
		0x00000000, 0x00000000, 0x00000000, 0xc8, 0x02,

		# Unlock test page #
		0x00000020, 0xffffffff, 0x00005555, 0x00, 0x00,
		0x00000020, 0xffffffff, 0x0000aaaa, 0x00, 0x00,

		# Download JUMP Instruction into RAM #
		0x00000c00, 0xffffffff, 0x00000000, 0x00, 0x00,
		0x00000c08, 0xffffffff, 0x00000001, 0x00, 0x00,
		0x00e02800, 0xffffffff, 0x00dd0102, 0x00, 0x00,
		0x00000c08, 0xffffffff, 0x00000000, 0x00, 0x00,

		# Enable PAC to execute code #
		0x00000c00, 0xffffffff, 0x00000001, 0x00, 0x00,

		# Delay 200 ms #
		0x00000000, 0x00000000, 0x00000000, 0xc8, 0x02,

		# Disable PAC to execute code #
		0x00000c00, 0xffffffff, 0x00000000, 0x00, 0x00,

		# Apply errata #
		# Correct gain flatness #
		0x00007064, 0xffffffff, 0x0929a800, 0x00, 0x00,
		0x00007850, 0xffffffff, 0x00002fa9, 0x00, 0x00,
		0x00007854, 0xffffffff, 0x0003f1d5, 0x00, 0x00,
		0x00007858, 0xffffffff, 0x0003f5e3, 0x00, 0x00,
		0x0000785c, 0xffffffff, 0x00001137, 0x00, 0x00,
		0x00007860, 0xffffffff, 0x0001a7a5, 0x00, 0x00,
		0x00007864, 0xffffffff, 0x0002f16a, 0x00, 0x00,
		0x00007868, 0xffffffff, 0x00003e21, 0x00, 0x00,
		0x00007848, 0xffffffff, 0x00000001, 0x00, 0x00,
		0x00002020, 0xffffffff, 0x00000000, 0x00, 0x00,

		# Fix group delay variation #
		0x00002d10, 0xffffffff, 0x0002c01c, 0x00, 0x00,

		# DC offset #
		0x00007418, 0xffffffff, 0x909001c8, 0x00, 0x00,

		# VBST Err threshold #
		0x0000394c, 0xffffffff, 0x028764b7, 0x00, 0x00,

		# Boost default #
		0x00003810, 0xffffffff, 0x00003c3c, 0x00, 0x00,

		# Update DCM to remove load detection #
		0x0000381c, 0xffffffff, 0x00000051, 0x00, 0x00,

		# Lock test page #
		0x00000020, 0xffffffff, 0x0000cccc, 0x00, 0x00,
		0x00000020, 0xffffffff, 0x00003333, 0x00, 0x00,

		# Set clocking #
		# PLL ref clk = SCLK at 3.072MHz = 48KHz * 64 #
		# Configure and enable PLL #
		0x00002c04, 0xffffffff, 0x00000c20, 0x00, 0x00,
		0x00002c04, 0xffffffff, 0x00000430, 0x00, 0x00,
		0x00002c0c, 0xffffffff, 0x00000003, 0x00, 0x00,

		# Set audio routing for both amplifiers #
		# ASP TX1 = IMON #
		0x00004c20, 0xffffffff, 0x00000019, 0x00, 0x00,
		# ASP TX2 = VMON1 #
		0x00004c24, 0xffffffff, 0x00000018, 0x00, 0x00,

		# Set audio format #
		# I2S Slave mode #
		0x00004808, 0xffffffff, 0x00000002, 0x00, 0x00,
		# RX Slot width = 32 and Data width = 24 bit #
		# TX Slot and Data width = 16 bit #
		0x00004818, 0xffffffff, 0x00200010, 0x00, 0x00,

		# TX in Hi-Z mode when not outputting #
		0x00004800, 0xffffffff, 0x00200024, 0x00, 0x00,

		# Enable blocks: AMP, BST, VBATMON, VBSTMON, TEMPMON, VMON1, IMON #
		0x00002018, 0xffffffff, 0x00003721, 0x00, 0x00,

		# Enable interrupt BST_SHORT_ERR, BST_DCM_UVP, BST_OVP_ERR, TEMP_ERR, TEMP_WARN #
		# Default value is 0xffbffffc #
		0x00d00040, 0xffffffff, 0xf9b8fffc, 0x00, 0x00,
		# Enable interrupt AMP_SHORT_ERR #
		# Default value is 0xf5ffffff #
		0x00d00048, 0xffffffff, 0xf5ffefff, 0x00, 0x00,

		# Gain set to 17dB #
		0x00006c04, 0xffffffff, 0x00000220, 0x00, 0x00}"
	/>

    <SCENCE NAME="POWER_ON_L" CONTROL_MASK="0x01" VALUE="{
    		# Left and right amp use diff slots #
		# TX1 = Slot 0, TX2 = Slot 2 #
		0x0000481c, 0xffffffff, 0x00020000, 0x00, 0x00,
		# RX1 = Slot 0 (Left Ch) #
		0x0000482c, 0xffffffff, 0x00000000, 0x00, 0x00,
		# Enable TX1 - TX2 and RX1 #
		0x0000483c, 0xffffffff, 0x00010003, 0x00, 0x00,

		# Unlock test page #
		0x00000020, 0xffffffff, 0x00005555, 0x00, 0x00,
		0x00000020, 0xffffffff, 0x0000aaaa, 0x00, 0x00,

		# Errata fix for amplifier gain due to VMON2 off #
		0x00004F34, 0xffffffff, 0x00008800, 0x00, 0x00,

		# Lock test page #
		0x00000020, 0xffffffff, 0x0000cccc, 0x00, 0x00,
		0x00000020, 0xffffffff, 0x00003333, 0x00, 0x00,

		# GLOBAL_EN = 1 #
		0x00002014, 0xffffffff, 0x00000001, 0x00, 0x00,
		# Delay 3 ms for power up to complete #
		0x00000000, 0x00000000, 0x00000000, 0x03, 0x02}"
	/>

    <SCENCE NAME="POWER_ON_R" CONTROL_MASK="0x10" VALUE="{
    		# Left and right amp use diff slots #
		# TX1 = Slot 1, TX2 = Slot 3 #
		0x0000481c, 0xffffffff, 0x00030001, 0x00, 0x00,
		# RX1 = Slot 1 (Right Ch) #
		0x0000482c, 0xffffffff, 0x00000001, 0x00, 0x00,
		# Enable TX1 - TX2 and RX1 #
		0x0000483c, 0xffffffff, 0x00010003, 0x00, 0x00,

		# Unlock test page #
		0x00000020, 0xffffffff, 0x00005555, 0x00, 0x00,
		0x00000020, 0xffffffff, 0x0000aaaa, 0x00, 0x00,

		# Errata fix for amplifier gain due to VMON2 off #
		0x00004F34, 0xffffffff, 0x00008800, 0x00, 0x00,

		# Lock test page #
		0x00000020, 0xffffffff, 0x0000cccc, 0x00, 0x00,
		0x00000020, 0xffffffff, 0x00003333, 0x00, 0x00,

		# GLOBAL_EN = 1 #
		0x00002014, 0xffffffff, 0x00000001, 0x00, 0x00,
		# Delay 3 ms for power up to complete #
		0x00000000, 0x00000000, 0x00000000, 0x03, 0x02}"
	/>

    <SCENCE NAME="POWER_OFF_L" CONTROL_MASK="0x01" VALUE="{
		# To avoid pop, mute audio stream before GLOBAL_EN = 0 #
		# If soft ramp enabled, ensure volume is muted #
		# GLOBAL_EN = 0 #
		0x00002014, 0xffffffff, 0x00000000, 0x00, 0x00,

		# Unlock test page #
		0x00000020, 0xffffffff, 0x00005555, 0x00, 0x00,
		0x00000020, 0xffffffff, 0x0000aaaa, 0x00, 0x00,

		# Restore default value #
		0x00004F34, 0xffffffff, 0x00000000, 0x00, 0x00,

		# Lock test page #
		0x00000020, 0xffffffff, 0x0000cccc, 0x00, 0x00,
		0x00000020, 0xffffffff, 0x00003333, 0x00, 0x00,

		# Delay 1 ms for power down to complete #
		0x00000000, 0x00000000, 0x00000000, 0x01, 0x02}"
	/>

    <SCENCE NAME="POWER_OFF_R" CONTROL_MASK="0x10" VALUE="{
		# To avoid pop, mute audio stream before GLOBAL_EN = 0 #
		# If soft ramp enabled, ensure volume is muted #
		# GLOBAL_EN = 0 #
		0x00002014, 0xffffffff, 0x00000000, 0x00, 0x00,

		# Unlock test page #
		0x00000020, 0xffffffff, 0x00005555, 0x00, 0x00,
		0x00000020, 0xffffffff, 0x0000aaaa, 0x00, 0x00,

		# Restore default value #
		0x00004F34, 0xffffffff, 0x00000000, 0x00, 0x00,

		# Lock test page #
		0x00000020, 0xffffffff, 0x0000cccc, 0x00, 0x00,
		0x00000020, 0xffffffff, 0x00003333, 0x00, 0x00,

		# Delay 1 ms for power down to complete #
		0x00000000, 0x00000000, 0x00000000, 0x01, 0x02}"
	/>
  </PA_STATUS>
</NV_CATEGORY>
